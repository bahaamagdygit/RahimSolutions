<div class="analytics-page">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">Analytics</h1>
      <p class="page-subtitle">Track your store performance and insights</p>
    </div>
    <div class="header-actions">
      <div class="period-selector">
        @for (period of periods; track period.value) {
          <button
            class="period-btn"
            [class.active]="selectedPeriod() === period.value"
            (click)="setPeriod(period.value)"
          >
            {{ period.label }}
          </button>
        }
      </div>
      <button class="btn btn-outline">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M14 10V12.6667C14 13.0203 13.8595 13.3594 13.6095 13.6095C13.3594 13.8595 13.0203 14 12.6667 14H3.33333C2.97971 14 2.64057 13.8595 2.39052 13.6095C2.14048 13.3594 2 13.0203 2 12.6667V10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M4.66667 6.66667L8 10L11.3333 6.66667" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M8 10V2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Export Report
      </button>
    </div>
  </div>

  <!-- Overview Stats -->
  <div class="stats-grid">
    @for (stat of overviewStats; track stat.label) {
      <div class="stat-card">
        <span class="stat-label">{{ stat.label }}</span>
        <span class="stat-value">{{ stat.value }}</span>
        <div class="stat-change" [class.positive]="stat.trend === 'up'" [class.negative]="stat.trend === 'down'">
          @if (stat.trend === 'up') {
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
              <path d="M6 9.5V2.5M6 2.5L2.5 6M6 2.5L9.5 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          } @else {
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
              <path d="M6 2.5V9.5M6 9.5L9.5 6M6 9.5L2.5 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          }
          <span>{{ stat.change > 0 ? '+' : '' }}{{ stat.change }}%</span>
        </div>
      </div>
    }
  </div>

  <!-- Charts Row -->
  <div class="charts-grid">
    <!-- Revenue Chart -->
    <div class="card chart-card">
      <div class="card-header">
        <h2 class="card-title">Revenue Overview</h2>
        <span class="card-subtitle">Monthly revenue trend</span>
      </div>
      <div class="chart-container">
        <div class="chart-bars">
          @for (value of revenueData.values; track $index; let i = $index) {
            <div class="chart-bar-wrapper">
              <div class="chart-value">{{ formatCurrency(value) }}</div>
              <div class="chart-bar revenue" [style.height.%]="(value / getMaxValue(revenueData)) * 100"></div>
              <span class="chart-label">{{ revenueData.labels[i] }}</span>
            </div>
          }
        </div>
      </div>
    </div>

    <!-- Visits Chart -->
    <div class="card chart-card">
      <div class="card-header">
        <h2 class="card-title">Weekly Visits</h2>
        <span class="card-subtitle">Visitor traffic by day</span>
      </div>
      <div class="chart-container">
        <div class="chart-bars">
          @for (value of visitsData.values; track $index; let i = $index) {
            <div class="chart-bar-wrapper">
              <div class="chart-value">{{ value.toLocaleString() }}</div>
              <div class="chart-bar visits" [style.height.%]="(value / getMaxValue(visitsData)) * 100"></div>
              <span class="chart-label">{{ visitsData.labels[i] }}</span>
            </div>
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Categories and Products Row -->
  <div class="data-grid">
    <!-- Top Categories -->
    <div class="card">
      <div class="card-header">
        <h2 class="card-title">Top Categories</h2>
        <span class="card-subtitle">Sales by category</span>
      </div>
      <div class="card-content">
        <div class="categories-list">
          @for (category of topCategories; track category.name) {
            <div class="category-item">
              <div class="category-info">
                <span class="category-dot" [style.background]="category.color"></span>
                <span class="category-name">{{ category.name }}</span>
              </div>
              <div class="category-stats">
                <span class="category-value">{{ formatCurrency(category.value) }}</span>
                <span class="category-percentage">{{ category.percentage }}%</span>
              </div>
              <div class="category-bar">
                <div class="category-progress" [style.width.%]="category.percentage" [style.background]="category.color"></div>
              </div>
            </div>
          }
        </div>
      </div>
    </div>

    <!-- Top Products -->
    <div class="card">
      <div class="card-header">
        <h2 class="card-title">Top Products</h2>
        <span class="card-subtitle">Best performing products</span>
      </div>
      <div class="card-content">
        <div class="products-table">
          <div class="table-header">
            <span class="col-rank">#</span>
            <span class="col-product">Product</span>
            <span class="col-views">Views</span>
            <span class="col-sales">Sales</span>
            <span class="col-revenue">Revenue</span>
          </div>
          @for (product of topProducts; track product.rank) {
            <div class="table-row">
              <span class="col-rank">
                <span class="rank-badge" [class.top-3]="product.rank <= 3">{{ product.rank }}</span>
              </span>
              <span class="col-product">{{ product.name }}</span>
              <span class="col-views">{{ product.views.toLocaleString() }}</span>
              <span class="col-sales">{{ product.sales }}</span>
              <span class="col-revenue">{{ formatCurrency(product.revenue) }}</span>
            </div>
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Traffic Sources -->
  <div class="card traffic-card">
    <div class="card-header">
      <h2 class="card-title">Traffic Sources</h2>
      <span class="card-subtitle">Where your visitors come from</span>
    </div>
    <div class="card-content">
      <div class="traffic-grid">
        @for (source of trafficSources; track source.source) {
          <div class="traffic-item">
            <div class="traffic-header">
              <span class="traffic-source">{{ source.source }}</span>
              <span class="traffic-percentage">{{ source.percentage }}%</span>
            </div>
            <div class="traffic-bar">
              <div class="traffic-progress" [style.width.%]="source.percentage"></div>
            </div>
            <span class="traffic-visits">{{ source.visits.toLocaleString() }} visits</span>
          </div>
        }
      </div>
    </div>
  </div>
</div>
