<div class="image-gallery">
  <!-- Main Image Display -->
  <div class="main-image-container">
    @if (currentImage) {
      <!-- Category Badges -->
      @if (config().categories && config().categories!.length > 0) {
        <div class="category-badges">
          @for (category of config().categories; track category) {
            <span class="category-badge">{{ category }}</span>
          }
        </div>
      }

      <!-- Main Image -->
      <img [src]="currentImage.src" [alt]="currentImage.alt" class="main-image" />

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button class="action-btn" (click)="onLike()" aria-label="Like">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M7 22V11M2 13V20C2 21.1046 2.89543 22 4 22H17.4262C18.907 22 20.1662 20.9197 20.3914 19.4562L21.4683 12.4562C21.7479 10.6389 20.3418 9 18.5032 9H15V4C15 2.89543 14.1046 2 13 2C12.4477 2 12 2.44772 12 3V3.5C12 4.79439 11.5646 6.04653 10.7675 7.04771L8.46482 10.0522C7.86948 10.8038 7 11.8743 7 13V22ZM7 22H14C15.1046 22 16 21.1046 16 20V13C16 11.8954 15.1046 11 14 11H7" stroke-linecap="round"/>
          </svg>
        </button>
        <button class="action-btn" (click)="onFavorite()" aria-label="Favorite">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
          </svg>
        </button>
        <button class="action-btn" (click)="onShare()" aria-label="Share">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
            <polyline points="16 6 12 2 8 6"/>
            <line x1="12" y1="2" x2="12" y2="15"/>
          </svg>
        </button>
      </div>

      <!-- Navigation Arrows -->
      @if (config().images.length > 1) {
        <button class="nav-arrow nav-arrow-left" (click)="previousImage()" aria-label="Previous image">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"/>
          </svg>
        </button>
        <button class="nav-arrow nav-arrow-right" (click)="nextImage()" aria-label="Next image">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"/>
          </svg>
        </button>
      }
    }
  </div>

  <!-- Thumbnail Gallery -->
  @if (config().images.length > 1) {
    <div class="thumbnail-gallery">
      @for (image of visibleThumbnails; track image.id; let i = $index) {
        <div
          class="thumbnail-item"
          [class.active]="i === currentImageIndex()"
          (click)="selectImage(i)"
        >
          @if (i === maxVisibleThumbnails - 1 && remainingImagesCount > 0) {
            <div class="more-images-overlay">
              <span>+{{ remainingImagesCount }} more</span>
            </div>
          }
          <img [src]="image.src" [alt]="image.alt" class="thumbnail-image" />
        </div>
      }
    </div>
  }

  <!-- Stats Bar -->
  <div class="stats-bar">
    @if (config().showLikes) {
      <div class="stat-item">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M7 22V11M2 13V20C2 21.1046 2.89543 22 4 22H17.4262C18.907 22 20.1662 20.9197 20.3914 19.4562L21.4683 12.4562C21.7479 10.6389 20.3418 9 18.5032 9H15V4C15 2.89543 14.1046 2 13 2C12.4477 2 12 2.44772 12 3V3.5C12 4.79439 11.5646 6.04653 10.7675 7.04771L8.46482 10.0522C7.86948 10.8038 7 11.8743 7 13V22ZM7 22H14C15.1046 22 16 21.1046 16 20V13C16 11.8954 15.1046 11 14 11H7"/>
        </svg>
        <span>{{ config().likesCount }}</span>
      </div>
    }
    @if (config().showComments) {
      <div class="stat-item">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
        </svg>
        <span>{{ config().commentsCount }}</span>
      </div>
    }
    @if (config().showViews) {
      <div class="stat-item">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
          <circle cx="12" cy="12" r="3"/>
        </svg>
        <span>{{ config().viewsCount }}</span>
      </div>
    }
  </div>
</div>
